import hashlib

def removeDuplicateRecords(input_file_path):
    # 1
    output_file_path = "filteredData.json"
    # input_file_path = "in.txt"

    # 2
    completed_lines_hash = set()

    # 3
    output_file = open(output_file_path, "a")

    # 4
    for line in open(input_file_path, "r"):
        # 5
        hashValue = hashlib.md5(line.rstrip().encode('utf-8')).hexdigest()
        # 6
        if hashValue not in completed_lines_hash:
            output_file.write(line)
            completed_lines_hash.add(hashValue)
    # 7
    output_file.close()

def concatenateFiles(filenames):
    with open('../fileout.json', 'w') as outfile:
        for fname in filenames:
            with open(fname) as infile:
                for line in infile:
                    outfile.write(line)

if __name__ == '__main__':
    # filenames = ['../file1.json', '../file2.json']
    # concatenateFiles(filenames)
    removeDuplicateRecords("../all.json")

    # train_pairs = [3099,3177,4131,5037,5054,5057,5066,5093,5094,5095,5096,5144,5189,5203,5271,5297,5307,5483,5505,5506,
    #                5517,5518,5672,5766,5824,5855,5950,8178,8210,8239,8383,8530,8531,8649,8689,8840,9135,9304,9381,9447,
    #                9485,9499,9647,9649,9816,9830,9831,9840,9853,10074,10075,10076,10091,10092,
    #                10178,10179,10241,10242,10244,10328,10435,10507,10515,10516,10609,10929,11379,11484,11634,11635,11714]
    # print(len(train_pairs))
    # animals = [26,27,31,112,127,132,137,138,214,215,259,283,298,299,305,356,374,424,457,540,555,5603,621,636,638,728,733,734,
    #            804,805,823,827,833,847,924,932,945,948,952,964,1024,1072,1085,1095,1097,1106,1124,1128,1134,1142,1147,1148,1152,
    #            1155,1157,1176,1177,1185,1215,1216,1224,1223,1250,1251,1252,1286,1314,1348,1375,1385,1386,1401,1407,1437,1438,
    #            1444,1448,1469,1472,1473,1474,1481,1496,1498,1499,1523,1527,1530,1543,1554,1561,1570,1575,1576,1592,1624,1650,1653,1654,1656,
    #            1657,1677,1682,1698,1710,1722,1745,1748,1767,1773,1777,1778,1783,1793,1818,1819,1820,1821,1822,1832,1863,1873,1884,1895,1896,
    #            1898,1906,1935,1938,1941,1948,1954,1961,1965,1966,1968,1977,1979,1980,1983,1984,2002,2003,2006,2009,2010,2015,2020,2031,2037,2039,2059,
    #            2078,2081,2103,2107,2110,2143,2150,2167,2184,2206,2210,2215,2223,2224,2252,2263,2277,2278,2281,2283,2288,2313,2319,2329,2331,2343, 2380,
    #            2381,2384,2395,2421,2434,2447,2466,2472,2515,2524,2530,2535,2542,2545,2547,2569,2570,2572,2587,2588,2591,2592,2606,2607,2608,2646,
    #            2657,2664,2685,2705,2733,2764,2786,2787,2802,2824,2839,2840,2906
    #            ]
    #
    # scooter =[2,5,7,12,31,33,37,38,54,58,61,88,101,105,119,132,136,147,167,174,175,196,201,203,207,216,217,219,248,257,258,268,271,277,305,
    #           313,327,329,333,337,348,366,377,381,382,385,395,405,443,449,454,455,476,490,585,586,622,637,661,671,717,766,793,837,910,966,
    #           981,1020,1021,1022,1030,1044,1054,1100,1114,1120,1148,1158,1185,1220,1222,1232,1236,1269,1279,1291,1333,1382,1444,1446,1482,
    #           1553,1573,1578,1652,1658,1683,1918,1925,1993,2096,2113,2195,2245,2248,2286,2301,2321]
    # print(len(animals))
    # print(len(scooter))
    # print('total:', len(animals)+len(scooter)+len(train_pairs))